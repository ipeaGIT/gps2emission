<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Emission model — emission_model • gtfs2emis</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Emission model — emission_model"><meta property="og:description" content="Estimate hot-exhaust emissions of public transport systems. This
function must be used together with transport_model."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gtfs2emis</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/gtfs2emis_emission_factor.html">Exploring Emission Factors</a>
    </li>
    <li>
      <a href="../articles/gtfs2emis_fleet_data.html">Preparing fleet data for gtfs2emis</a>
    </li>
    <li>
      <a href="../articles/gtfs2emis_intro_vignette.html">Getting started</a>
    </li>
    <li>
      <a href="../articles/gtfs2emis_non_exhaust_ef.html">Exploring Non-Exhaust Emission Factors</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/ipeaGIT/gtfs2emis/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Emission model</h1>
    <small class="dont-index">Source: <a href="https://github.com/ipeaGIT/gtfs2emis/blob/master/R/emission_model.R" class="external-link"><code>R/emission_model.R</code></a></small>
    <div class="hidden name"><code>emission_model.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Estimate hot-exhaust emissions of public transport systems. This
function must be used together with <code><a href="transport_model.html">transport_model</a></code>.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">emission_model</span><span class="op">(</span></span>
<span>  <span class="va">tp_model</span>,</span>
<span>  <span class="va">ef_model</span>,</span>
<span>  <span class="va">fleet_data</span>,</span>
<span>  <span class="va">pollutant</span>,</span>
<span>  reference_year <span class="op">=</span> <span class="fl">2020</span>,</span>
<span>  process <span class="op">=</span> <span class="st">"hot_exhaust"</span>,</span>
<span>  heightfile <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  parallel <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  ncores <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  output_path <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  continue <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  quiet <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-tp-model">tp_model<a class="anchor" aria-label="anchor" href="#arg-tp-model"></a></dt>
<dd><p>sf_linestring object or a character path the to sf_linestring objects.
The <code>tp_model</code> is the output from <code><a href="transport_model.html">transport_model</a></code>,
or the path in which the output files from the <code><a href="transport_model.html">transport_model</a></code> are saved.</p></dd>


<dt id="arg-ef-model">ef_model<a class="anchor" aria-label="anchor" href="#arg-ef-model"></a></dt>
<dd><p>character. A string indicating the emission factor model
to be used. Options include <code>ef_usa_moves</code>, <code>ef_usa_emfac</code>,<code>ef_europe_emep</code>,
,<code>ef_brazil_cetesb</code>, and <code>ef_brazil_scaled_euro</code> (scale <code><a href="ef_brazil_cetesb.html">ef_brazil_cetesb()</a></code> based
on <code><a href="ef_scaled_euro.html">ef_scaled_euro()</a></code>).</p></dd>


<dt id="arg-fleet-data">fleet_data<a class="anchor" aria-label="anchor" href="#arg-fleet-data"></a></dt>
<dd><p>data.frame. A <code>data.frame</code> with information the fleet
characteristics. The required columns depend on the
<code>ef_model</code> selection. See @examples for input.</p></dd>


<dt id="arg-pollutant">pollutant<a class="anchor" aria-label="anchor" href="#arg-pollutant"></a></dt>
<dd><p>character. Vector with one or more pollutants to be estimated.
Example: <code>c("CO", "CO2", "PM10", "NOx")</code>. See the documentation to check which
pollutants are available for each emission factor model (<code>ef_usa_moves</code>, <code>ef_usa_emfac</code>,
<code>ef_europe_emep</code>, or <code>ef_brazil_cetesb</code>).</p></dd>


<dt id="arg-reference-year">reference_year<a class="anchor" aria-label="anchor" href="#arg-reference-year"></a></dt>
<dd><p>numeric. Year of reference considered to calculate the
emissions inventory. Defaults to <code>2020</code>. This
argument is only required when the <code>ef_model</code>
parameter is <code>ef_usa_moves</code> or <code>ef_usa_emfac</code>.</p></dd>


<dt id="arg-process">process<a class="anchor" aria-label="anchor" href="#arg-process"></a></dt>
<dd><p>character; Emission process, classified in "hot_exhaust" (Default),
and wear processes (identified as "tyre","brake" and/or "road" wear).
Note that wear processes are only available when the <code>ef_europe_emep</code> is
selected in the @param ef_model. Details on wear emissions are presented in
<code><a href="emi_europe_emep_wear.html">emi_europe_emep_wear</a></code>.</p></dd>


<dt id="arg-heightfile">heightfile<a class="anchor" aria-label="anchor" href="#arg-heightfile"></a></dt>
<dd><p>character or raster data. The raster file with height data,
or its filepath, used to estimate emissions considering the effect of
street slope. This argument is used only when <code>ef_brazil_scaled_euro</code> or
<code>ef_europe_emep</code> are selected. Default is <code>NULL</code>. Details are provided in
<code><a href="slope_class_europe_emep.html">slope_class_europe_emep</a></code>.</p></dd>


<dt id="arg-parallel">parallel<a class="anchor" aria-label="anchor" href="#arg-parallel"></a></dt>
<dd><p>logical. Decides whether the function should run in parallel.
Defaults is <code>TRUE</code>.</p></dd>


<dt id="arg-ncores">ncores<a class="anchor" aria-label="anchor" href="#arg-ncores"></a></dt>
<dd><p>integer. Number of cores to be used in parallel execution. This
argument is ignored if parallel is <code>FALSE</code>. Default (<code>NULL</code>) selects
the total number of available cores minus one.</p></dd>


<dt id="arg-output-path">output_path<a class="anchor" aria-label="anchor" href="#arg-output-path"></a></dt>
<dd><p>character. File path where the function output is exported.
If <code>NULL</code> (Default), the function returns the output to user.</p></dd>


<dt id="arg-continue">continue<a class="anchor" aria-label="anchor" href="#arg-continue"></a></dt>
<dd><p>logical. Argument that can be used only with output_path When TRUE,
it skips processing the shape identifiers that were already saved into
files. It is useful to continue processing a GTFS file that was stopped
for some reason. Default value is FALSE.</p></dd>


<dt id="arg-quiet">quiet<a class="anchor" aria-label="anchor" href="#arg-quiet"></a></dt>
<dd><p>Logical; Display messages from the emissions or emission factor functions.
Default is 'TRUE'.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A <code>list</code> with emissions estimates or <code>NULL</code> with output files saved
locally at <code>output_path</code>.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The <code>fleet_data</code> must be a <code>data.frame</code> organized according to the desired
<code>ef_model</code>. The required columns is organized as follows (see @examples for real
data usage).</p><ul><li><p><code>veh_type</code>: character; Bus type, classified according to the @param ef_model .
For <code>ef_emep_europe</code>, use "Ubus Midi &lt;=15 t","Ubus Std 15 - 18 t",
"Ubus Artic &gt;18 t", "Coaches Std &lt;=18 t" or "Coaches Artic &gt;18 t"; For
<code>ef_usa_moves</code> or <code>ef_usa_emfac</code>, use "BUS_URBAN_D"; For <code>ef_brazil_cetesb</code>,
use "BUS_URBAN_D", "BUS_MICRO_D", "BUS_COACH_D" or "BUS_ARTIC_D".</p></li>
<li><p><code>type_name_eu</code>: character; Bus type, used only for @param ef_model <code>ef_scaled_euro</code>
are selected. The classes can be "Ubus Midi &lt;=15 t","Ubus Std 15 - 18 t",
"Ubus Artic &gt;18 t", "Coaches Std &lt;=18 t" or "Coaches Artic &gt;18 t".</p></li>
<li><p><code>reference_year</code>: character; Base year of the emission factor model input.
Required only when  <code>ef_usa_moves</code> or <code>ef_usa_emfac</code> are selected.</p></li>
<li><p><code>tech</code>: character; After treatment technology. This is required only
when <code>emep_europe</code> is selected. Check <code>?ef_emep_europe</code> for details.</p></li>
<li><p><code>euro</code>: character; Euro period of vehicle, classified in
"Conventional", "I", "II", "III", "IV", "V", "VI", and "EEV". This is required only
when <code>ef_emep_europe</code> is selected. Check <code>ef_europe_emep</code> for details.</p></li>
<li><p><code>fuel</code>: character; Required when <code>ef_usa_moves</code>, <code>ef_usa_emfac</code> and
<code>ef_europe_emep</code> are selected.</p></li>
<li><p><code>fleet_composition</code>: Numeric. Scaled composition of fleet. In most
cases, the user might not know which vehicles run on each specific routes.
The composition is used to attribute a probability of a specific vehicle to
circulate in the line. The probability sums one. Required for all emission
factors selection.
Users can check the <a href="https://ipeagit.github.io/gtfs2emis/articles/gtfs2emis_fleet_data.html" class="external-link">gtfs2emis fleet data vignette</a>,
for more examples.</p></li>
</ul><p>Based on the input height data, the function returns the slope class between
two consecutive bus stop positions of a LineString Simple Feature
(transport model object). The slope is given by the ratio between the height
difference and network distance from two consecutive public transport stops.
The function classifies the slope into one of the seven categories
available on the European Environmental Agency (EEA) database, which is -0.06,
-0.04,-0.02, 0.00, 0.02, 0.04, and 0.06.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>Other Core function:
<code><a href="transport_model.html">transport_model</a>()</code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span> <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"gtfstools"</span>, quietly<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># read GTFS</span></span></span>
<span class="r-in"><span><span class="va">gtfs_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/bra_cur_gtfs.zip"</span>, package <span class="op">=</span> <span class="st">"gtfs2emis"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">gtfs</span> <span class="op">&lt;-</span> <span class="fu">gtfstools</span><span class="fu">::</span><span class="fu"><a href="https://ipeagit.github.io/gtfstools/reference/read_gtfs.html" class="external-link">read_gtfs</a></span><span class="op">(</span><span class="va">gtfs_file</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># keep a single trip_id to speed up this example</span></span></span>
<span class="r-in"><span><span class="va">gtfs_small</span> <span class="op">&lt;-</span> <span class="fu">gtfstools</span><span class="fu">::</span><span class="fu"><a href="https://ipeagit.github.io/gtfstools/reference/filter_by_trip_id.html" class="external-link">filter_by_trip_id</a></span><span class="op">(</span><span class="va">gtfs</span>, trip_id <span class="op">=</span><span class="st">"4451136"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span><span class="co"># run transport model</span></span></span>
<span class="r-in"><span><span class="va">tp_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="transport_model.html">transport_model</a></span><span class="op">(</span>gtfs_data <span class="op">=</span> <span class="va">gtfs_small</span>,</span></span>
<span class="r-in"><span>                            min_speed <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>                            max_speed <span class="op">=</span> <span class="fl">80</span>,</span></span>
<span class="r-in"><span>                            new_speed <span class="op">=</span> <span class="fl">20</span>,</span></span>
<span class="r-in"><span>                            spatial_resolution <span class="op">=</span> <span class="fl">100</span>,</span></span>
<span class="r-in"><span>                            parallel <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example using Brazilian emission model and fleet</span></span></span>
<span class="r-in"><span><span class="va">fleet_data_ef_cetesb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>veh_type <span class="op">=</span> <span class="st">"BUS_URBAN_D"</span>,</span></span>
<span class="r-in"><span>                                   model_year <span class="op">=</span> <span class="fl">2010</span><span class="op">:</span><span class="fl">2019</span>,</span></span>
<span class="r-in"><span>                                   fuel <span class="op">=</span> <span class="st">"D"</span>,</span></span>
<span class="r-in"><span>                                   fleet_composition <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span>                                   <span class="op">)</span></span></span>
<span class="r-in"><span>                                   </span></span>
<span class="r-in"><span><span class="va">emi_cetesb</span> <span class="op">&lt;-</span> <span class="fu">progressr</span><span class="fu">::</span><span class="fu"><a href="https://progressr.futureverse.org/reference/with_progress.html" class="external-link">with_progress</a></span><span class="op">(</span><span class="fu">emission_model</span><span class="op">(</span></span></span>
<span class="r-in"><span>                tp_model <span class="op">=</span> <span class="va">tp_model</span>,</span></span>
<span class="r-in"><span>                ef_model <span class="op">=</span> <span class="st">"ef_brazil_cetesb"</span>,</span></span>
<span class="r-in"><span>                fleet_data <span class="op">=</span> <span class="va">fleet_data_ef_cetesb</span>,</span></span>
<span class="r-in"><span>                pollutant <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CO"</span>,<span class="st">"PM10"</span>,<span class="st">"CO2"</span>,<span class="st">"CH4"</span>,<span class="st">"NOx"</span><span class="op">)</span></span></span>
<span class="r-in"><span>                <span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>                            </span></span>
<span class="r-in"><span><span class="co"># Example using European emission model and fleet</span></span></span>
<span class="r-in"><span><span class="va">fleet_data_ef_europe</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>  veh_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Ubus Midi &lt;=15 t"</span>,</span></span>
<span class="r-in"><span>                                                  <span class="st">"Ubus Std 15 - 18 t"</span>,</span></span>
<span class="r-in"><span>                                                  <span class="st">"Ubus Artic &gt;18 t"</span><span class="op">)</span></span></span>
<span class="r-in"><span>                                   , euro <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"III"</span>,<span class="st">"IV"</span>,<span class="st">"V"</span><span class="op">)</span></span></span>
<span class="r-in"><span>                                   , fuel <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"D"</span>,<span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span>                                   , tech <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"-"</span>,<span class="st">"SCR"</span>,<span class="st">"SCR"</span><span class="op">)</span></span></span>
<span class="r-in"><span>                                   , fleet_composition <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.4</span>,<span class="fl">0.5</span>,<span class="fl">0.1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>                                   </span></span>
<span class="r-in"><span><span class="va">emi_emep</span> <span class="op">&lt;-</span> <span class="fu">progressr</span><span class="fu">::</span><span class="fu"><a href="https://progressr.futureverse.org/reference/with_progress.html" class="external-link">with_progress</a></span><span class="op">(</span><span class="fu">emission_model</span><span class="op">(</span>tp_model <span class="op">=</span> <span class="va">tp_model</span></span></span>
<span class="r-in"><span>                          , ef_model <span class="op">=</span> <span class="st">"ef_europe_emep"</span></span></span>
<span class="r-in"><span>                          , fleet_data <span class="op">=</span> <span class="va">fleet_data_ef_europe</span></span></span>
<span class="r-in"><span>                          , pollutant <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PM10"</span>,<span class="st">"NOx"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">emi_emep_wear</span> <span class="op">&lt;-</span> <span class="fu">progressr</span><span class="fu">::</span><span class="fu"><a href="https://progressr.futureverse.org/reference/with_progress.html" class="external-link">with_progress</a></span><span class="op">(</span><span class="fu">emission_model</span><span class="op">(</span>tp_model <span class="op">=</span> <span class="va">tp_model</span></span></span>
<span class="r-in"><span>                          , ef_model <span class="op">=</span> <span class="st">"ef_europe_emep"</span></span></span>
<span class="r-in"><span>                          , fleet_data <span class="op">=</span> <span class="va">fleet_data_ef_europe</span></span></span>
<span class="r-in"><span>                          , pollutant <span class="op">=</span> <span class="st">"PM10"</span></span></span>
<span class="r-in"><span>                          , process <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"tyre"</span>,<span class="st">"road"</span>,<span class="st">"brake"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">raster_cur</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/bra_cur-srtm.tif"</span>, package <span class="op">=</span> <span class="st">"gtfs2emis"</span><span class="op">)</span>                           </span></span>
<span class="r-in"><span><span class="va">emi_emep_slope</span> <span class="op">&lt;-</span> <span class="fu">progressr</span><span class="fu">::</span><span class="fu"><a href="https://progressr.futureverse.org/reference/with_progress.html" class="external-link">with_progress</a></span><span class="op">(</span><span class="fu">emission_model</span><span class="op">(</span>tp_model <span class="op">=</span> <span class="va">tp_model</span></span></span>
<span class="r-in"><span>                          , ef_model <span class="op">=</span> <span class="st">"ef_europe_emep"</span></span></span>
<span class="r-in"><span>                          , fleet_data <span class="op">=</span> <span class="va">fleet_data_ef_europe</span></span></span>
<span class="r-in"><span>                          , heightfile <span class="op">=</span> <span class="va">raster_cur</span></span></span>
<span class="r-in"><span>                          , pollutant <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PM10"</span>,<span class="st">"NOx"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>  </span></span>
<span class="r-in"><span>                                                  </span></span>
<span class="r-in"><span><span class="co"># Example using US EMFAC emission model and fleet</span></span></span>
<span class="r-in"><span><span class="va">fleet_data_ef_moves</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>  veh_type <span class="op">=</span> <span class="st">"BUS_URBAN_D"</span></span></span>
<span class="r-in"><span>                                  , model_year <span class="op">=</span> <span class="fl">2010</span><span class="op">:</span><span class="fl">2019</span></span></span>
<span class="r-in"><span>                                  , fuel <span class="op">=</span> <span class="st">"D"</span></span></span>
<span class="r-in"><span>                                  , reference_year <span class="op">=</span> <span class="fl">2020</span></span></span>
<span class="r-in"><span>                                  , fleet_composition <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>                                  </span></span>
<span class="r-in"><span><span class="va">fleet_data_ef_emfac</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>  veh_type <span class="op">=</span>  <span class="st">"BUS_URBAN_D"</span></span></span>
<span class="r-in"><span>                                  , model_year <span class="op">=</span> <span class="fl">2010</span><span class="op">:</span><span class="fl">2019</span></span></span>
<span class="r-in"><span>                                  , fuel <span class="op">=</span> <span class="st">"D"</span></span></span>
<span class="r-in"><span>                                  , reference_year <span class="op">=</span> <span class="fl">2020</span></span></span>
<span class="r-in"><span>                                  , fleet_composition <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>                                  </span></span>
<span class="r-in"><span><span class="co"># Example using US MOVES emission model and fleet</span></span></span>
<span class="r-in"><span><span class="va">emi_moves</span> <span class="op">&lt;-</span> <span class="fu">emission_model</span><span class="op">(</span>tp_model <span class="op">=</span> <span class="va">tp_model</span></span></span>
<span class="r-in"><span>                          , ef_model <span class="op">=</span> <span class="st">"ef_usa_moves"</span></span></span>
<span class="r-in"><span>                          , fleet_data <span class="op">=</span> <span class="va">fleet_data_ef_moves</span></span></span>
<span class="r-in"><span>                          , pollutant <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CO"</span>,<span class="st">"PM10"</span>,<span class="st">"CO2"</span>,<span class="st">"CH4"</span>,<span class="st">"NOx"</span><span class="op">)</span></span></span>
<span class="r-in"><span>                          , reference_year <span class="op">=</span> <span class="fl">2020</span><span class="op">)</span></span></span>
<span class="r-in"><span>                          </span></span>
<span class="r-in"><span><span class="va">emi_emfac</span> <span class="op">&lt;-</span> <span class="fu">emission_model</span><span class="op">(</span>tp_model <span class="op">=</span> <span class="va">tp_model</span></span></span>
<span class="r-in"><span>                          , ef_model <span class="op">=</span> <span class="st">"ef_usa_emfac"</span></span></span>
<span class="r-in"><span>                          , fleet_data <span class="op">=</span> <span class="va">fleet_data_ef_emfac</span></span></span>
<span class="r-in"><span>                          , pollutant <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CO"</span>,<span class="st">"PM10"</span>,<span class="st">"CO2"</span>,<span class="st">"CH4"</span>,<span class="st">"NOx"</span><span class="op">)</span></span></span>
<span class="r-in"><span>                          , reference_year <span class="op">=</span> <span class="fl">2020</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Converting shapes to sf objects</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Processing the data</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Constant emission factor along the route</span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Joao Bazzo, Rafael H. M. Pereira, Pedro R. Andrade, Ipea - Institute for Applied Economic Research.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

