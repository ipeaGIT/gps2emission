<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Transport model — transport_model • gtfs2emis</title><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Transport model — transport_model"><meta name="description" content="This function converts a public transport data set in GTFS format into a
GPS-like table with the space-time positions and speeds of public transport
vehicles. The function also allow users to set the spatial resolution of the
output and to adjust the speed of public transport vehicles given a
min_speed and max_speed range."><meta property="og:description" content="This function converts a public transport data set in GTFS format into a
GPS-like table with the space-time positions and speeds of public transport
vehicles. The function also allow users to set the spatial resolution of the
output and to adjust the speed of public transport vehicles given a
min_speed and max_speed range."><meta property="og:image" content="https://ipeagit.github.io/gtfs2emis/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">gtfs2emis</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.1.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/gtfs2emis_emission_factor.html">Exploring Emission Factors</a></li>
    <li><a class="dropdown-item" href="../articles/gtfs2emis_fleet_data.html">Preparing fleet data for gtfs2emis</a></li>
    <li><a class="dropdown-item" href="../articles/gtfs2emis_intro_vignette.html">Getting started</a></li>
    <li><a class="dropdown-item" href="../articles/gtfs2emis_non_exhaust_ef.html">Exploring Non-Exhaust Emission Factors</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ipeaGIT/gtfs2emis/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Transport model</h1>
      <small class="dont-index">Source: <a href="https://github.com/ipeaGIT/gtfs2emis/blob/master/R/transport_model.R" class="external-link"><code>R/transport_model.R</code></a></small>
      <div class="d-none name"><code>transport_model.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function converts a public transport data set in GTFS format into a
GPS-like table with the space-time positions and speeds of public transport
vehicles. The function also allow users to set the spatial resolution of the
output and to adjust the speed of public transport vehicles given a
<code>min_speed</code> and <code>max_speed</code> range.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">transport_model</span><span class="op">(</span></span>
<span>  <span class="va">gtfs_data</span>,</span>
<span>  min_speed <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  max_speed <span class="op">=</span> <span class="fl">80</span>,</span>
<span>  new_speed <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  parallel <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  ncores <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  spatial_resolution <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  output_path <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  continue <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-gtfs-data">gtfs_data<a class="anchor" aria-label="anchor" href="#arg-gtfs-data"></a></dt>
<dd><p>A path to a GTFS file or a GTFS data organized as a list of
<code>data.tables</code> created with <code><a href="https://ipeagit.github.io/gtfstools/reference/read_gtfs.html" class="external-link">gtfstools::read_gtfs()</a></code>.</p></dd>


<dt id="arg-min-speed">min_speed<a class="anchor" aria-label="anchor" href="#arg-min-speed"></a></dt>
<dd><p>numeric (in km/h) or a speed units value. Minimum speed to
be considered as valid. Values below minimum speed will be updated
according to the <code>new_speed</code> parameter, which can affect the arrival
and  departure times of vehicles at  transit stops. Defaults to <code>2</code>
km/h.</p></dd>


<dt id="arg-max-speed">max_speed<a class="anchor" aria-label="anchor" href="#arg-max-speed"></a></dt>
<dd><p>numeric (in km/h) or a speed units value. Maximum speed to
be considered as valid. Values above maximum speed will be  updated
according to the <code>new_speed</code> parameter, which can affect the arrival
and departure times of vehicles at transit stops. Defaults to <code>80</code>
km/h.</p></dd>


<dt id="arg-new-speed">new_speed<a class="anchor" aria-label="anchor" href="#arg-new-speed"></a></dt>
<dd><p>numeric (in km/h) or a speed units value. Speed value used
to replace the speeds that fall outside the <code>min_speed</code> and <code>max_speed</code>
range or which are missing from the GTFS input. When <code>new_speed = NULL</code>
(the default), the function uses the average speed of the entire GTFS
data feed.</p></dd>


<dt id="arg-parallel">parallel<a class="anchor" aria-label="anchor" href="#arg-parallel"></a></dt>
<dd><p>logical. Decides whether the function should run in parallel.
Defaults is <code>TRUE</code>.</p></dd>


<dt id="arg-ncores">ncores<a class="anchor" aria-label="anchor" href="#arg-ncores"></a></dt>
<dd><p>integer. Number of cores to be used in parallel execution. This
argument is ignored if parallel is <code>FALSE</code>. Default (<code>NULL</code>) selects
the total number of available cores minus one.</p></dd>


<dt id="arg-spatial-resolution">spatial_resolution<a class="anchor" aria-label="anchor" href="#arg-spatial-resolution"></a></dt>
<dd><p>The spatial resolution in meters. Defaults to <code>100</code>.
The function only creates points in order to guarantee that the
minimum distance between two consecutive points will be at most the
<code>spatial_resolution</code> value. If a given GTFS shape_id has two
consecutive points with a distance smaller than the spatial resolution,
the algorithm will not remove such points.</p></dd>


<dt id="arg-output-path">output_path<a class="anchor" aria-label="anchor" href="#arg-output-path"></a></dt>
<dd><p>character. A directory path. If <code>NULL</code> (Default), the
function returns the output. If the user passes a valid <code>passed</code>, the
output will be saved in the <code>output_path</code> dir. Note that that the
output of each public transport <code>shape_id</code> is saved separately in
different files. Setting an <code>output_path</code> is recommended when working
with large public transport system because the output of the function
can be significantly large.</p></dd>


<dt id="arg-continue">continue<a class="anchor" aria-label="anchor" href="#arg-continue"></a></dt>
<dd><p>logical. Argument that can be used only with output_path When TRUE,
it skips processing the shape identifiers that were already saved into
files. It is useful to continue processing a GTFS file that was stopped
for some reason. Default value is FALSE.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>data.table sf_linestring</code> object or <code>NULL</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other Core function:
<code><a href="emission_model.html">emission_model</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"gtfstools"</span>, quietly<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># read GTFS</span></span></span>
<span class="r-in"><span><span class="va">gtfs_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/bra_cur_gtfs.zip"</span>, package <span class="op">=</span> <span class="st">"gtfs2emis"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">gtfs</span> <span class="op">&lt;-</span> <span class="fu">gtfstools</span><span class="fu">::</span><span class="fu"><a href="https://ipeagit.github.io/gtfstools/reference/read_gtfs.html" class="external-link">read_gtfs</a></span><span class="op">(</span><span class="va">gtfs_file</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># keep a single trip_id to speed up this example</span></span></span>
<span class="r-in"><span><span class="va">gtfs_small</span> <span class="op">&lt;-</span> <span class="fu">gtfstools</span><span class="fu">::</span><span class="fu"><a href="https://ipeagit.github.io/gtfstools/reference/filter_by_trip_id.html" class="external-link">filter_by_trip_id</a></span><span class="op">(</span><span class="va">gtfs</span>, trip_id <span class="op">=</span><span class="st">"4451136"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span><span class="co"># run transport model</span></span></span>
<span class="r-in"><span><span class="va">tp_model</span> <span class="op">&lt;-</span> <span class="fu">transport_model</span><span class="op">(</span>gtfs_data <span class="op">=</span> <span class="va">gtfs_small</span>,</span></span>
<span class="r-in"><span>                            min_speed <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>                            max_speed <span class="op">=</span> <span class="fl">80</span>,</span></span>
<span class="r-in"><span>                            new_speed <span class="op">=</span> <span class="fl">20</span>,</span></span>
<span class="r-in"><span>                            spatial_resolution <span class="op">=</span> <span class="fl">100</span>,</span></span>
<span class="r-in"><span>                            parallel <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Converting shapes to sf objects</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Processing the data</span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Joao Bazzo, Rafael H. M. Pereira, Pedro R. Andrade, Ipea - Institute for Applied Economic Research.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

